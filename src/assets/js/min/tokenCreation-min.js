function creditCardTransaction(){var e=JSON.stringify($("#card-review-form").serializeObject());console.log(e),$.ajax({type:"POST",url:"https://api.itransact.com/transactions",headers:{authorization:encodedUsername+":"+signiture,"content-type":"application/json"},processData:!0,data:e,success:function(e){console.log(date),console.log("Reaches here")}})}function xhrLogin(){var e="<FundML> \n                      <Version>1</Version> \n                      <Request> \n                          <Code>LogOn</Code>\n                          <Online>Y</Online>        \n                          <Broker> \n                              <Username>aj.larson@3pnc.com</Username>\n                              <Password>Larsonaj</Password>            \n                          </Broker> \n                      </Request> \n                  </FundML>",n=new XMLHttpRequest;n.addEventListener("readystatechange",function(){4===this.readyState}),n.open("POST","https://www.redplanetsoftware.com/odyssey/fundml.aspx"),n.overrideMimeType("text/xml"),n.onload=function(){if(n.readyState===n.DONE&&200===n.status){var e=$("Session",n.response).text();xhrContractCreation(e)}},n.send(e)}function xhrContractCreation(e){var n="<FundML> \n                        <Version>1</Version> \n                        <Request> \n                            <Code>NewContract</Code>\n                            <Session>"+e+"</Session> \n                            <Client>\n                              <ABN>454545456</ABN>\n                              <Name>Test Company LLC</Name>\n                              <RegisteredName>TestComp</RegisteredName>\n                              <BrokerID>TestComp</BrokerID>   \n                                  <PostalAddress>\n                                  <Address1></Address1>\n                                  <Address2/>\n                                  <Suburb></Suburb>\n                                  <State></State>\n                                  <Postcode></Postcode>\n                              </PostalAddress>\n                              <StreetAddress>\n                                  <Address1>2500 Dallas Pkwy STE 300</Address1>\n                                  <Address2/>\n                                  <Suburb>Plano</Suburb>\n                                  <State>TX</State>\n                                  <Postcode>75093</Postcode>\n                              </StreetAddress>\n                              <Telephone>1234567890</Telephone>\n                              <Fax></Fax>\n                              <Email>test@test.com</Email>\n                              <FSRAType></FSRAType>\n                              <BankAccountOnly>12345678</BankAccountOnly>\n                              <BankBSB>12345678</BankBSB>\n                              <BankName>Westpac Banking Corp</BankName>\n                              <BankBranch>George Street</BankBranch>\n                              <Contact>\n                                  <Name>Test User</Name>\n                                  <Telephone>4698797001</Telephone>\n                                  <Mobile>4698797001</Mobile>\n                                  <Fax></Fax>\n                                  <Email>test@test.com</Email>\n                              </Contact>\n                          </Client>\n                           <InvoiceDetails>\n                                   <InvoicesTotal>14500.00</InvoicesTotal>\n                                   <InvoiceNumbers>999</InvoiceNumbers>\n                            </InvoiceDetails>                   \n                            <ContractDetails>\n                                  <ContractReference/>\n                                  <PaymentFrequency>M</PaymentFrequency>\n                                  <ContractType>FEE</ContractType>\n                                 <ContractVersion/>\n                                 <CreatedDate>2017-10-17</CreatedDate>\n                                 <TerminationDate/>\n                                  <FirstInstalmentDate>2017-10-29</FirstInstalmentDate>\n                                  <FirstInstalmentAmount>1398.96</FirstInstalmentAmount>\n                                  <NumberOfInstalments>12</NumberOfInstalments>\n                                  <RemainingInstalmentsAmount>1298.96</RemainingInstalmentsAmount>\n                                  <AdminFee>100.00</AdminFee>\n                                  <InterestCharges>987.50</InterestCharges>\n                                  <TotalInvoices>14500.00</TotalInvoices>\n                                  <TotalDueByClient>15587.50</TotalDueByClient>\n                            </ContractDetails>\n                        </Request> \n                    </FundML> ",t=new XMLHttpRequest;t.addEventListener("readystatechange",function(){4===this.readyState}),t.open("POST","https://www.redplanetsoftware.com/odyssey/fundml.aspx"),t.overrideMimeType("text/xml"),t.onload=function(){t.readyState===t.DONE&&200===t.status&&(console.log(t.response),window.alert(t.response))},t.send(n)}function contractCreation(e){var n="<FundML> \n                        <Version>1</Version> \n                        <Request> \n                            <Code>NewContract</Code> \n                            <Online>Y</Online>\n                            <Session>"+e+"</Session> \n                            <Client> \n                                <ABN>10987654321</ABN> \n                                <Name>OpenCut Mining</Name> \n                                <RegisteredName>Emerald Mines Pty Ltd</RegisteredName> \n                                <BrokerID>OPENCUT</BrokerID> \n                                <PostalAddress> \n                                    <Address1>PO Box 321</Address1> \n                                    <Address2/> \n                                    <Suburb>Melbourne</Suburb> \n                                    <State>VIC</State> \n                                    <Postcode>3000</Postcode> \n                                </PostalAddress> \n                                <StreetAddress> \n                                    <Address1>23 Smith Street</Address1> \n                                    <Address2/> \n                                    <Suburb>Collingwood</Suburb> \n                                    <State>VIC</State> \n                                    <Postcode>3056</Postcode> \n                                </StreetAddress> \n                                <Telephone>(03) 9222 1234</Telephone> \n                                <Fax>(03) 9222 4321</Fax> \n                                <Email>enquiries@opencut.com.au</Email> \n                                <FSRAType></FSRAType> \n                                <BankAccountOnly>12345678</BankAccountOnly> \n                                <BankBSB>12345678</BankBSB>\n                                <BankName>Westpac Banking Corp</BankName> \n                                <BankBranch>George    Street</BankBranch> \n                                <Contact> \n                                    <Name>Stephen Adams</Name> \n                                    <Telephone>9222 1235</Telephone> \n                                    <Mobile>0412 222 5633</Mobile> \n                                    <Fax>9222 4322</Fax> \n                                    <Email>stephena@opencut.com.au</Email> \n                                </Contact> \n                            </Client> \n                             <InvoiceDetails>\n                                     <InvoicesTotal>1500</InvoicesTotal>\n                                     <InvoiceNumbers>123</InvoiceNumbers>\n                              </InvoiceDetails>          \n                              <ContractDetails> \n                                    <ContractReference>M00000456</ContractReference> \n                                    <PaymentFrequency>M</PaymentFrequency> \n                                   <ContractType>FEE</ContractType> \n                              <ContractVersion/> \n                              <CreatedDate>2017-10-04</CreatedDate> \n                              <TerminationDate/> \n                                    <FirstInstalmentDate>2017-10-29</FirstInstalmentDate> \n                                    <FirstInstalmentAmount>211.97</FirstInstalmentAmount> \n                                    <NumberOfInstalments>12</NumberOfInstalments> \n                                    <RemainingInstalmentsAmount>157.72</RemainingInstalmentsAmount> \n                                    <AdminFee>0.00</AdminFee> \n                                    <InterestCharges>0.00</InterestCharges> \n                                    <TotalInvoices>1892.64</TotalInvoices> \n                                    <TotalDueByClient>1892.64</TotalDueByClient>    \n                              </ContractDetails> \n                        </Request> \n                    </FundML> \n                    ";$.ajax({type:"POST",url:"https://www.redplanetsoftware.com/odyssey/fundml.aspx",contentType:"text/plain",data:n,success:function(e){console.log(e)}})}var encodedUsername="bW9udGdvbWVyeV9jb3NjaWFfZ3JlX051OHBXa1lq",signiture=$('input[name="paymentSigniture"]').val();jQuery.fn.serializeObject=function(){var e=this,n={},t={},a={validate:/^[a-zA-Z][a-zA-Z0-9_]*(?:\[(?:\d*|[a-zA-Z0-9_]+)\])*$/,key:/[a-zA-Z0-9_]+|(?=\[\])/g,push:/^$/,fixed:/^\d+$/,named:/^[a-zA-Z0-9_]+$/};return this.build=function(e,n,t){return e[n]=t,e},this.push_counter=function(e){return void 0===t[e]&&(t[e]=0),t[e]++},$.each($(this).serializeArray(),function(){if(a.validate.test(this.name)){for(var t,s=this.name.match(a.key),r=this.value,o=this.name;void 0!==(t=s.pop());)o=o.replace(new RegExp("\\["+t+"\\]$"),""),t.match(a.push)?r=e.build([],e.push_counter(o),r):t.match(a.fixed)?r=e.build([],t,r):t.match(a.named)&&(r=e.build({},t,r));n=$.extend(!0,n,r)}}),delete n.submitReviewForm,delete n.paymentToken,delete n.paymentSigniture,delete n.siteUrl,n},$("#monthly-payment-form").validate({errorClass:"error",validClass:"success",errorElement:"span",onkeyup:!1,rules:{"card[cvc]":{cardCVC:!0,required:!0},"card[number]":{cardNumber:!0,required:!0},"card[expiry-year]":"cardExpiry"},submitHandler:function(e,n){n.preventDefault(),$('input[name="amount"]').val(100*$('input[name="amount"]').val()),e.submit()}}),$("#review-form").validate({errorClass:"error",validClass:"success",errorElement:"span",onkeyup:!1,rules:{},submitHandler:function(e,n){n.preventDefault(),xhrLogin()}}),$("#card-review-form").validate({errorClass:"error",validClass:"success",errorElement:"span",onkeyup:!1,rules:{},submitHandler:function(e,n){n.preventDefault(),creditCardTransaction()}});